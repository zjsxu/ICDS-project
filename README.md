many credits due to chatgpt.com
the issue we wanna fix is: in v2 and especially v3, we've reinforced the algorithm, however the performance was not improved too much
for the codes, please read my comments and important things are inside
